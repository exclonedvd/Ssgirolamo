<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Agriturismo Corte San Girolamo</title>
  <meta name="theme-color" content="#5b4636" />
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="icons/icon-192.png" />
  <style>
    :root {
      --bg: #f6f4f1;
      --text: #222;
      --muted: #6b6b6b;
      --brand: #000;
      --card: #fff;
      --border: #e5e5e5;
      --radius: 16px;
      --shadow: 0 8px 24px rgba(0,0,0,.08);
    }
    * { box-sizing: border-box; }
    html, body { margin:0; background:var(--bg); color:var(--text); font-family: system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji'; }
    a { color: inherit; text-decoration: none; }
    img { max-width: 100%; display: block; }

    .container { max-width: 1100px; margin: 0 auto; padding: 0 16px; }
    .section { padding: 48px 0; }
    h1,h2,h3 { margin: 0 0 12px; }
    h2 { font-size: clamp(24px, 2.6vw, 32px); }
    .btn { display:inline-flex; align-items:center; justify-content:center; padding: 10px 16px; border-radius: 14px; border: 1px solid var(--border); background: #fff; cursor:pointer; }
    .btn-primary { background:#000; color:#fff; border-color:#000; }
    .btn-ghost { background:transparent; border-color:#fff; color:#fff; }
    .chips { display:flex; flex-wrap:wrap; gap:8px; }
    .chip { font-size:12px; padding:6px 10px; border-radius:999px; border:1px solid var(--border); background:#f3f3f3; }

    /* Header */
    .header { position: sticky; top:0; z-index:40; backdrop-filter:saturate(180%) blur(10px); background: rgba(255,255,255,.7); border-bottom:1px solid var(--border); }
    .nav { display:flex; align-items:center; justify-content:space-between; height:64px; }
    .nav-left { display:flex; align-items:center; gap:12px; font-weight:600; }
    .nav-links { display:flex; align-items:center; gap:18px; font-size:14px; }
    .nav-toggle { display:none; width:40px; height:40px; border:1px solid var(--border); border-radius:10px; align-items:center; justify-content:center; background:#fff; }
    @media (max-width: 768px) {
      .nav-links { display:none; }
      .nav-toggle { display:flex; }
      .mobile-menu { display:block; border-top:1px solid var(--border); background:#fff; }
      .mobile-menu a { display:block; padding:12px 16px; }
    }

    /* Hero */
    .hero { position:relative; display:flex; align-items:center; height: min(70vh, 700px); color:#fff; }
    .hero::before { content:''; position:absolute; inset:0; background:linear-gradient(rgba(0,0,0,.35), rgba(0,0,0,.35)); z-index:0; }
    .hero .inner { position:relative; z-index:1; }
    .hero h1 { font-size: clamp(28px, 4.5vw, 48px); font-weight:700; }
    .hero p  { font-size: clamp(16px, 2vw, 20px); opacity:.95; margin-bottom: 16px; }
    .hero-cta { display:flex; gap:10px; flex-wrap:wrap; }

    /* Cards */
    .grid { display:grid; gap: 18px; }
    .grid-3 { grid-template-columns: repeat(3, 1fr); }
    .grid-4 { grid-template-columns: repeat(4, 1fr); }
    @media (max-width: 1024px){ .grid-3 { grid-template-columns: repeat(2, 1fr); } .grid-4 { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 640px) { .grid-3, .grid-4 { grid-template-columns: 1fr; } }
    .card { border:1px solid var(--border); border-radius: var(--radius); background: var(--card); overflow:hidden; box-shadow: var(--shadow); }
    .card .img { height: 220px; object-fit: cover; width:100%; }
    .card .body { padding:16px; }

    /* Gallery */
    .tabs { display:flex; gap: 10px; flex-wrap:wrap; margin-bottom: 14px; }
    .tab { padding:8px 14px; border-radius: 12px; border:1px solid var(--border); background:#fff; font-size: 14px; }
    .tab.active { background:#000; color:#fff; border-color:#000; }
    .gallery { display:grid; grid-template-columns: repeat(3, 1fr); gap:10px; }
    @media (max-width: 900px) { .gallery { grid-template-columns: repeat(2, 1fr);} }
    @media (max-width: 560px) { .gallery { grid-template-columns: 1fr;} }
    .gallery img { width:100%; height: 220px; object-fit: cover; border-radius: 12px; }
    .badge { position:absolute; left:6px; right:6px; bottom:6px; font-size:12px; background: rgba(0,0,0,.55); color:#fff; padding: 4px 8px; border-radius: 8px; }

    /* Map */
    iframe { border:0; }

    /* Footer + Sticky */
    footer { border-top:1px solid var(--border); margin-top: 24px; }
    .footer-top { display:grid; gap:24px; grid-template-columns: repeat(3, 1fr); padding: 24px 0; }
    @media (max-width: 900px){ .footer-top { grid-template-columns: 1fr; } }
    .sticky { position:fixed; bottom:0; left:0; right:0; background:rgba(255,255,255,.95); border-top:1px solid var(--border); }
    .sticky .bar { height:64px; display:flex; align-items:center; gap: 10px; }
    .sticky a { flex:1; display:flex; align-items:center; justify-content:center; height:44px; border-radius:12px; border:1px solid var(--border); background:#fff; }
    .sticky a.primary { background:#000; color:#fff; border-color:#000; }

    .muted { color: var(--muted); }
    .mt-8 { margin-top: 32px; }
    .mt-4 { margin-top: 16px; }
  </style>

  <!-- React + ReactDOM + Babel -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useMemo } = React;

    const SETTINGS = {
      NAME: "Agriturismo Corte San Girolamo",
      TAGLINE: "B&B nel Parco del Mincio – Mantova",
      PHONE: "+39 347 800 8505",
      WHATSAPP: "393478008505",
      EMAIL: "info@agriturismo-sangirolamo.it",
      ADDRESS: "Str. S. Girolamo, 1, 46100 Mantova MN",
      HERO_IMAGE: "media/esterni/esterni-001.webp",
      LOGO_URL: "logo.jpg"
    };

    const CONTENT_DEFAULT = { rooms: [], exteriors: [], breakfast: [], gallery: [], hero: "" };
    const normalizeImages = (list) => Array.isArray(list) ? list.map((it)=> (typeof it === "string" ? {src:it, label:""} : {src:it?.src, label:it?.label||""})).filter(x=>!!x.src) : [];

    function useContent() {
      const [content, setContent] = React.useState(CONTENT_DEFAULT);
      React.useEffect(() => {
        const base = "content.json";
        const sep = base.includes("?") ? "&" : "?";
        const url = base + sep + "v=" + Date.now();
        fetch(url, { cache: "no-store" })
          .then(r => r.ok ? r.json() : null)
          .then(j => { if (j) setContent({ rooms: normalizeImages(j.images?.rooms||[]), exteriors: normalizeImages(j.images?.exteriors||[]), breakfast: normalizeImages(j.images?.breakfast||[]), gallery: normalizeImages(j.images?.gallery||[]), hero: j.hero || "" }); })
          .catch(()=>{});
      }, []);
      return content;
    }

    const DICT = {
      it: {
        nav: { rooms: "Camere", restaurant: "Ristoro & Colazione", experiences: "Esperienze", gallery: "Galleria", map: "Mappa", contact: "Contatti" },
        hero: { title: SETTINGS.NAME, subtitle: SETTINGS.TAGLINE, cta: "Richiedi disponibilità", secondary: "Scopri le camere" },
        booking: { title:"Richiesta disponibilità", name:"Nome e cognome", email:"Email", phone:"Telefono", checkin:"Arrivo", checkout:"Partenza", guests:"Ospiti", room:"Alloggio", notes:"Richieste/Note", est:"Stima", nights:(n)=>`${n} notte${n===1?"":"i"}`, openWhatsApp:"Apri WhatsApp", or:"oppure", emailUs:"Invia email" },
        rooms: { title:"Le nostre camere" }, gallery: { title:"Galleria" }, map:{ title:"Dove siamo", openNav:"Indicazioni" }, contact:{ title:"Contatti", call:"Chiama", write:"Scrivici", address:"Indirizzo" }
      }
    };

    function Navbar() {
      const [open, setOpen] = useState(false);
      return (
        <header className="header">
          <div className="container nav">
            <a href="#" className="nav-left">
              <img src={SETTINGS.LOGO_URL} alt="logo" width="32" height="32" style={{borderRadius:12}}/>
              <span>{SETTINGS.NAME}</span>
            </a>
            <nav className="nav-links">
              <a href="#rooms">{DICT.it.nav.rooms}</a>
              <a href="#restaurant">{DICT.it.nav.restaurant}</a>
              <a href="#experiences">{DICT.it.nav.experiences}</a>
              <a href="#gallery">{DICT.it.nav.gallery}</a>
              <a href="#map">{DICT.it.nav.map}</a>
              <a href="#contact">{DICT.it.nav.contact}</a>
            </nav>
            <button className="nav-toggle" onClick={()=>setOpen(v=>!v)} aria-label="Menu">☰</button>
          </div>
          {open && (
            <div className="mobile-menu">
              <div className="container">
                <a href="#rooms">{DICT.it.nav.rooms}</a>
                <a href="#restaurant">{DICT.it.nav.restaurant}</a>
                <a href="#experiences">{DICT.it.nav.experiences}</a>
                <a href="#gallery">{DICT.it.nav.gallery}</a>
                <a href="#map">{DICT.it.nav.map}</a>
                <a href="#contact">{DICT.it.nav.contact}</a>
              </div>
            </div>
          )}
        </header>
      );
    }

    function Hero({ heroSrc }) {
      const bg = heroSrc || SETTINGS.HERO_IMAGE;
      const style = { backgroundImage: `url(${bg})`, backgroundSize:"cover", backgroundPosition:"center" };
      return (
        <div className="hero" style={style}>
          <div className="container inner">
            <h1>{DICT.it.hero.title}</h1>
            <p>{DICT.it.hero.subtitle}</p>
            <div className="hero-cta">
              <a href="#booking" className="btn btn-primary">{DICT.it.hero.cta}</a>
              <a href="#rooms" className="btn btn-ghost">{DICT.it.hero.secondary}</a>
            </div>
          </div>
        </div>
      );
    }

    const ROOMS = [
      { id:"ulivo", name_it:"Camera Ulivo", price:95, pax:2, size:20, img:"media/camere/camere-001.webp", amenities:["Wi‑Fi","Climatizzazione","Bagno privato","Colazione"] },
      { id:"vigna", name_it:"Camera Vigna", price:120, pax:3, size:26, img:"media/camere/camere-002.webp", amenities:["Vista panoramica","Wi‑Fi","Climatizzazione","Colazione"] },
      { id:"mare",  name_it:"Suite Mare",   price:160, pax:4, size:35, img:"media/camere/camere-003.webp", amenities:["Terrazza","Angolo cottura","Wi‑Fi","Colazione"] },
    ];

    const Section = ({id, title, children}) => (
      <section id={id} className="section">
        <div className="container">
          {title && <h2>{title}</h2>}
          {children}
        </div>
      </section>
    );

    const Rooms = () => (
      <Section id="rooms" title={DICT.it.rooms.title}>
        <div className="grid grid-3">
          {ROOMS.map((r) => (
            <div key={r.id} className="card">
              <img src={r.img} alt={r.name_it} className="img"/>
              <div className="body">
                <div style={{display:'flex', justifyContent:'space-between', alignItems:'center'}}>
                  <h3 style={{fontSize:18, fontWeight:600}}>{r.name_it}</h3>
                  <div><span style={{fontWeight:700}}>€ {r.price}</span> <span className="muted">/notte</span></div>
                </div>
                <div className="muted">{r.size} m² • {r.pax} pax</div>
                <div className="chips mt-4">{r.amenities.map(a => <span className="chip" key={a}>{a}</span>)}</div>
              </div>
            </div>
          ))}
        </div>
      </Section>
    );

    function Gallery({ images }) {
      const [tab, setTab] = useState("all");
      const all = (images.rooms||[]).slice(0,6).concat((images.exteriors||[]).slice(0,6)).concat((images.breakfast||[]).slice(0,6)).concat(images.gallery||[]).slice(0,15);
      const current = tab==="all" ? all : (images[tab] || []);
      return (
        <Section id="gallery" title={DICT.it.gallery.title}>
          <div className="tabs">
            <button className={"tab" + (tab==="all"?" active":"")} onClick={()=>setTab("all")}>Tutte</button>
            <button className={"tab" + (tab==="rooms"?" active":"")} onClick={()=>setTab("rooms")}>Camere</button>
            <button className={"tab" + (tab==="exteriors"?" active":"")} onClick={()=>setTab("exteriors")}>Esterni</button>
            <button className={"tab" + (tab==="breakfast"?" active":"")} onClick={()=>setTab("breakfast")}>Colazione</button>
          </div>
          <div className="gallery">
            {current.map((it,i) => (
              <div key={i} style={{position:'relative'}}>
                <img src={it.src} alt={it.label || `ph-${i}`} />
                {it.label && <div className="badge">{it.label}</div>}
              </div>
            ))}
          </div>
        </Section>
      );
    }

    const Map = () => {
      const q = encodeURIComponent(SETTINGS.ADDRESS);
      const src = `https://www.google.com/maps?q=${q}&z=14&output=embed`;
      return (
        <Section id="map" title={"Dove siamo"}>
          <div className="card" style={{overflow:'hidden'}}>
            <iframe title="map" src={src} style={{width:'100%', height:400}} loading="lazy" referrerPolicy="no-referrer-when-downgrade"></iframe>
          </div>
          <div className="mt-4">
            <a className="btn btn-primary" href={`https://www.google.com/maps/dir/?api=1&destination=${q}`} target="_blank" rel="noreferrer">Indicazioni</a>
          </div>
        </Section>
      );
    };

    const Contact = () => (
      <Section id="contact" title={"Contatti"}>
        <div className="grid grid-3">
          <div className="card"><div className="body"><div className="muted">Chiama</div><a href={"tel:"+SETTINGS.PHONE} style={{fontSize:18}}>{SETTINGS.PHONE}</a></div></div>
          <div className="card"><div className="body"><div className="muted">Scrivici</div><a href={"mailto:"+SETTINGS.EMAIL}>{SETTINGS.EMAIL}</a></div></div>
          <div className="card"><div className="body"><div className="muted">Indirizzo</div><div>{SETTINGS.ADDRESS}</div></div></div>
        </div>
      </Section>
    );

    const Footer = () => (
      <footer>
        <div className="container footer-top">
          <div style={{display:'flex', gap:12, alignItems:'center'}}>
            <img src={SETTINGS.LOGO_URL} alt="logo" width="40" height="40" style={{borderRadius:14}}/>
            <div><div style={{fontWeight:600}}>{SETTINGS.NAME}</div><div className="muted">{SETTINGS.TAGLINE}</div></div>
          </div>
          <div>
            <div style={{fontWeight:600, marginBottom:8}}>Contatti</div>
            <div><a href={"tel:"+SETTINGS.PHONE}>{SETTINGS.PHONE}</a></div>
            <div><a href={"mailto:"+SETTINGS.EMAIL}>{SETTINGS.EMAIL}</a></div>
            <div>{SETTINGS.ADDRESS}</div>
          </div>
          <div>
            <div style={{fontWeight:600, marginBottom:8}}>Link</div>
            <div><a href="#rooms">Camere</a></div>
            <div><a href="#restaurant">Ristoro & Colazione</a></div>
            <div><a href="#experiences">Esperienze</a></div>
            <div><a href="#gallery">Galleria</a></div>
          </div>
        </div>
        <div className="container" style="text-align:center; padding-bottom:24px; font-size:12px; color:#666;">© <span id="year"></span> {SETTINGS.NAME}. All rights reserved.</div>
      </footer>
    );

    const StickyBar = () => (
      <div className="sticky">
        <div className="container bar">
          <a href={"tel:"+SETTINGS.PHONE}>📞 Chiama</a>
          <a href={"https://wa.me/"+SETTINGS.WHATSAPP}>💬 WhatsApp</a>
          <a className="primary" href={"https://www.google.com/maps/dir/?api=1&destination="+encodeURIComponent(SETTINGS.ADDRESS)}>➤ Indicazioni</a>
        </div>
      </div>
    );

    function App() {
      const content = useContent();
      const heroSrc = content.hero || (content.exteriors[0]?.src) || SETTINGS.HERO_IMAGE;
      useEffect(()=>{
        const y = document.getElementById("year"); if (y) y.textContent = new Date().getFullYear();
        if ("serviceWorker" in navigator) navigator.serviceWorker.register("sw.js").catch(()=>{});
      }, []);
      return (
        <div>
          <Navbar />
          <Hero heroSrc={heroSrc} />
          <Section id="restaurant" title="Ristoro & Colazione">
            <div className="grid grid-3">
              <div className="card"><img className="img" src="media/galleria/galleria-001.webp" alt=""/></div>
              <div className="card"><img className="img" src="media/galleria/galleria-002.webp" alt=""/></div>
              <div className="card"><img className="img" src="media/galleria/galleria-003.webp" alt=""/></div>
            </div>
          </Section>
          <Rooms />
          <Gallery images={content} />
          <Map />
          <Contact />
          <Footer />
          <StickyBar />
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
